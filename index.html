<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<title>Soccer Predictor</title>

<style>
:root{
  --accent:#00ffff;
  --bg:#065565;
  --text:#fff;
  --card-bg:rgba(0,0,0,.6);
  --cookie-bg:rgba(0,0,0,.85);
}
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
  border:2px solid var(--accent);
  min-height:100vh;
  overflow-x:hidden;
  position:relative;
}
.hidden{display:none}
p{text-align:center;margin-top:70px;margin-bottom:10px}

/* SIDENAV */
.sidenav{
  height:100%;
  width:0;
  position:fixed;
  z-index:1;
  top:0;
  left:0;
  background-color:#065565;
  overflow-x:hidden;
  transition:.5s;
  padding-top:60px;
}
.sidenav a{
  padding:8px 8px 8px 28px;
  text-decoration:none;
  font-size:25px;
  color:#fff;
  display:block;
  transition:.3s;
}
.sidenav a:hover{color:#f85356}
.sidenav .closebtn{
  position:absolute;
  top:0;
  right:48px;
  font-size:36px;
  margin-left:50px;
}

/* HEADER */
.header-bar{
  position:fixed;
  top:0;
  left:0;
  right:0;
  margin:auto;
  text-align:center;
  background:#000;
  color:var(--accent);
  padding:12px;
  font-size:28px;
  cursor:pointer;
  z-index:9999;
}

/* OVERLAYS */
#overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:9999;
}
#bottom-alert{
  font-weight:700;
  font-size:16px;
  animation:blink 1.8s linear infinite;
  color:#fff;
}
@keyframes blink{
  0%,50%,100%{opacity:1}
  25%,75%{opacity:.25}
}
.spinner{
  width:40px;
  height:40px;
  border:5px solid rgba(255,255,255,.3);
  border-top:5px solid var(--accent);
  border-radius:50%;
  animation:spin 1s linear infinite;
  margin-bottom:12px;
}
@keyframes spin{to{transform:rotate(360deg)}}

#offline-overlay{
  position:fixed;
  inset:0;
  background:#000;
  color:#f55;
  font-size:22px;
  font-weight:700;
  text-align:center;
  justify-content:center;
  align-items:center;
  z-index:10001;
  display:none;
}

/* MAIN */
.main{padding:10px 12px 50px}
.card{
  background:var(--card-bg);
  border-radius:12px;
  padding:12px;
  margin-bottom:16px;
  box-shadow:0 0 12px rgba(0,0,0,.7);
}
.card:last-child{margin-bottom:10px}
.card-header{
  display:flex;
  justify-content:space-between;
  font-weight:700;
  margin-bottom:8px;
}
.card-header small{color:#ccc}
.day-title{
  color:var(--accent);
  text-align:center;
  font-size:20px;
  font-weight:700;
  margin:10px 0 12px;
}

/* FOOTER */
.footer{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  text-align:center;
  background:#000;
  color:var(--accent);
  padding:8px 0;
  border-top:2px solid var(--accent);
  z-index:1000;
}

/* COOKIE */
#cookie-banner{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:var(--cookie-bg);
  color:#fff;
  padding:12px;
  display:flex;
  flex-wrap:wrap;
  justify-content:space-between;
  align-items:center;
  font-size:14px;
  border-top:2px solid var(--accent);
  z-index:11000;
}
#cookie-banner span{flex:1 1 220px;margin-bottom:6px}
#cookie-banner button{
  background:var(--accent);
  color:#000;
  border:none;
  border-radius:6px;
  padding:8px 14px;
  font-weight:700;
  cursor:pointer;
}
#cookie-banner.hidden{display:none}

canvas{max-width:100%}

input[type=date]{
  padding:4px 6px;
  border-radius:4px;
  border:1px solid var(--accent);
  background:#000;
  color:var(--accent);
}

@media(min-width:900px){
  .card{max-width:600px;margin:12px auto;padding:10px}
}
</style>
</head>

<body>

<div id="overlay">
  <div class="spinner"></div>
  <div id="bottom-alert">Wait, data is loading...</div>
</div>

<div id="offline-overlay">Offline â€¢ Reloading...</div>

<div id="cookie-banner" class="hidden">
  <span>This site uses cookies to improve your experience.</span>
  <button id="cookieAccept">OK</button>
</div>

<div id="deferred-root" class="hidden">

  <div id="mySidenav" class="sidenav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <a href="#">WhatsApp</a>
    <a href="#">Email</a>
    <a href="#">Facebook</a>
    <a href="#">YouTube</a>
  </div>

  <div id="headerBar" class="header-bar" onclick="openNav()">
    &#9776;&nbsp;<b>SOCCER PREDICTOR</b>
  </div>

  <p>Select matches by date <input type="date" id="date-selector"></p>

  <div id="day-title" class="day-title"></div>

  <main class="main" id="content"></main>

</div>

<div class="footer">&copy;2026 cl@udiuz</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>

<script>
const overlay = document.getElementById("overlay");
const bottomAlert = document.getElementById("bottom-alert");
const offlineOverlay = document.getElementById("offline-overlay");
const deferredRoot = document.getElementById("deferred-root");
const content = document.getElementById("content");
const dateSelector = document.getElementById("date-selector");
const cookieBanner = document.getElementById("cookie-banner");
const cookieBtn = document.getElementById("cookieAccept");
const dayTitle = document.getElementById("day-title");

let retryTimer = null;

/* SIDENAV */
function openNav(){
  document.getElementById("mySidenav").style.width="100%";
  document.getElementById("headerBar").style.display="none";
}
function closeNav(){
  document.getElementById("mySidenav").style.width="0";
  document.getElementById("headerBar").style.display="block";
}

/* COOKIE */
cookieBtn.onclick = () => {
  localStorage.setItem("cookieNoticeAccepted","true");
  cookieBanner.classList.add("hidden");
};

/* OFFLINE HANDLING */
function scheduleRetry(ms = 5000){
  clearTimeout(retryTimer);
  retryTimer = setTimeout(() => fetchJSON(dateSelector.value || null), ms);
}
function showOffline(){
  overlay.style.display="flex";
  bottomAlert.style.display="block";
  bottomAlert.textContent="RETRYING...";
  deferredRoot.classList.add("hidden");
  offlineOverlay.style.display="flex";
  scheduleRetry();
}
function reveal(){
  overlay.style.display="none";
  bottomAlert.style.display="none";
  offlineOverlay.style.display="none";
  deferredRoot.classList.remove("hidden");
}

/* RENDER MATCH CARDS */
function renderPredictions(list){
  content.innerHTML = "";

  list.forEach((item, index) => {
    const home = parseFloat(item.home) || 0;
    const away = parseFloat(item.away) || 0;
    const btts = parseFloat(item.btts) || 0;

    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
      <div class="card-header">
        <div>${item.match}<br><small>Date: ${item.date}</small></div>
        <div>Pred: ${item.pred}</div>
      </div>
      <canvas id="chart-${index}" height="150"></canvas>
    `;

    content.appendChild(card);

    const ctx = document.getElementById(`chart-${index}`).getContext("2d");

    new Chart(ctx,{
      type:"bar",
      data:{
        labels:["Home %","Away %","BTTS %"],
        datasets:[{
          label:"Prediction",
          data:[home, away, btts],
          backgroundColor:[
            "rgba(0,255,255,0.8)",
            "rgba(255,215,0,0.8)",
            "rgba(255,80,80,0.8)"
          ],
          borderColor:["#00ffff","#ffd700","#ff4c4c"],
          borderWidth:2,
          barThickness:26
        }]
      },
      options:{
        responsive:true,
        animation:false,
        plugins:{
          legend:{display:false},
          datalabels:{
            color:"#fff",
            font:{weight:"bold",size:11},
            anchor:"end",
            align:"start",
            formatter:v=>v+"%",
            textStrokeColor:"#000",
            textStrokeWidth:3
          }
        },
        scales:{
          y:{beginAtZero:true,max:100,ticks:{color:"#fff"}},
          x:{ticks:{color:"#fff"}}
        }
      },
      plugins:[ChartDataLabels]
    });
  });
}

/* FETCH JSON FROM /data/ */
async function fetchJSON(date = null){
  clearTimeout(retryTimer);

  overlay.style.display="flex";
  bottomAlert.style.display="block";
  bottomAlert.textContent="WAIT, DATA IS LOADING...";

  try{
    if(!date){
      const today = new Date().toISOString().slice(0,10);
      date = today;
    }

    const response = await fetch(`data/${date}.json`, { cache:"no-store" });

    if(!response.ok){
      content.innerHTML = "";
      reveal();
      return;
    }

    const arr = await response.json();
    const list = Array.isArray(arr) ? arr : [];

    if(list.length === 0){
      content.innerHTML = "";
      reveal();
      return;
    }

    const d = list[0].date.toString().trim().slice(0,10);

    dateSelector.value = d;
    dayTitle.textContent = new Date(d).toLocaleDateString("en-US",{
      year:"numeric",
      month:"long",
      day:"numeric"
    });

    renderPredictions(list);
    reveal();

    if(navigator.onLine && !localStorage.getItem("cookieNoticeAccepted")){
      cookieBanner.classList.remove("hidden");
    }

  }catch(err){
    showOffline();
  }
}

/* EVENTS */
dateSelector.addEventListener("input", e=>{
  const d = e.target.value;
  if(d){
    dayTitle.textContent = new Date(d).toLocaleDateString("en-US",{
      year:"numeric",
      month:"long",
      day:"numeric"
    });
  }
  fetchJSON(d);
});

window.addEventListener("offline", showOffline);
window.addEventListener("online", () => fetchJSON(dateSelector.value || null));

/* INIT */
navigator.onLine ? fetchJSON() : showOffline();
</script>

</body>
</html>

